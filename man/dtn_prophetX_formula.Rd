% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dtn_prophetX_formula.R
\name{dtn_prophetX_formula}
\alias{dtn_prophetX_formula}
\title{Build a DTN ProphetX AIHIST RTD formula}
\usage{
dtn_prophetX_formula(symbol, time_scale, date, field)
}
\arguments{
\item{symbol}{Character. ProphetX instrument symbol (e.g., \code{"BEANS.20254.B"}).}

\item{time_scale}{Character. Time scale such as \code{"Daily"}, \code{"Weekly"}, or \code{"Monthly"}.}

\item{date}{Date or string convertible to Date. The Excel serial number is computed relative to 1899-12-30.}

\item{field}{Character. Field(s) to request, such as \code{"Open"}, \code{"High"},
\code{"Low"}, \code{"Close"}, or \code{"Description"}.}
}
\value{
A character string containing a valid Excel formula of the form:
\preformatted{
=IFERROR(RTD("prophetx.rtdserver","","AIHIST",symbol,time_scale,"1",date,"",field,"XD"),0)
}
}
\description{
Constructs a single-cell Excel formula string for the DTN ProphetX
\code{AIHIST} RTD function. This can be passed to \code{rb_eval_single()}
to evaluate historical data directly from Excel
via COM automation.
}
\details{
\itemize{
\item The returned string is not evaluated in R; it must be written into an Excel
cell using \code{rb_eval_single()}.
\item The \code{date} argument is converted to an Excel serial (days since 1899-12-30).
\item Wrapping with \code{IFERROR(...,0)} ensures Excel returns \code{0} if the RTD call fails.
}
}
